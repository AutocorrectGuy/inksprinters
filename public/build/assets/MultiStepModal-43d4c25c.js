import{r as c,j as e}from"./app-e2877b50.js";import{F as u,a as f}from"./index-4aaaf61c.js";import{u as S}from"./ExcelToTextContext-d22aef8b.js";import j from"./StepSelectSheet-5a717d52.js";import g from"./StepSelectColumns-89d5e3b5.js";import{S as b,C as E}from"./StepEditAndExport-e2e22fd4.js";import w from"./useUpdateModalContentHeight-cf428a08.js";import"./lineSpacingHandler-fd100f05.js";import"./TableHeaderCell-2a8d5544.js";import"./TextEditorOptions-b9545f7d.js";import"./collectForeignCharacters-97d77e93.js";import"./MonacoEditor-eb46fa1b.js";import"./ForgeignCharTerminal-d1d96a90.js";const d=["Select Sheet","Select Column(s)","Edit & Export"],D=({dialogRef:n})=>{const{currentStep:t,setCurrentStep:l,resetContext:m,sheetData:x}=S(),r=c.useRef(null),p=w(r),a=s=>t<d.length-1&&l(t+(s??1)),i=s=>t>0&&l(t-(s??1)),o=()=>m(()=>n.current.close());return c.useEffect(()=>{const s=h=>{h.key==="Escape"&&o()};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[n,o]),e.jsxs("dialog",{ref:n,className:"modal",children:[e.jsxs("div",{className:"modal-box flex max-w-4xl flex-col text-left",style:{height:window.innerHeight-100},children:[e.jsx("form",{method:"dialog",children:e.jsx("button",{className:"btn btn-circle btn-ghost btn-sm absolute right-4 top-1 mt-4",tabIndex:7,onClick:o,children:e.jsx(u,{icon:f,className:"h-8 w-8"})})}),e.jsx("div",{className:"flex-grow",children:t!==null&&x?e.jsxs("div",{className:"h-full w-full",children:[e.jsx("h3",{ref:r,className:"green-500 pb-4 text-center text-3xl font-bold",children:d[t]}),e.jsxs("div",{style:{height:p},children:[t===0&&e.jsx(j,{handleNextStep:a}),t===1&&e.jsx(g,{handlePreviousStep:i,handleNextStep:a}),t===2&&e.jsx(b,{handlePreviousStep:i})]})]}):e.jsx("div",{className:"flex h-full items-center justify-center",children:e.jsx("span",{className:"loading loading-spinner loading-lg"})})})]}),e.jsx("form",{method:"dialog",className:"modal-backdrop min-h-screen bg-black bg-opacity-80",onClick:o,children:e.jsx("button",{tabIndex:-1,children:"close"})}),e.jsx(E,{})]})};export{D as default};
