import{j as t,r as x}from"./app-769e5196.js";import{k,Q as f}from"./ReactToastify-072e765c.js";import{f as C,a as T,b as E,c as O}from"./index-14966fff.js";import{F as g}from"./index.es-4b25b74c.js";const y={position:"top-right",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!1,progress:void 0,theme:"dark"},I=()=>t.jsx(k,{position:"top-right",autoClose:5e3,hideProgressBar:!0,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!1,draggable:!1,pauseOnHover:!0,theme:"dark",style:{zIndex:9999}}),U=I;let h;const R=new Uint8Array(16);function D(){if(!h&&(h=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!h))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return h(R)}const o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));function L(e,n=0){return o[e[n+0]]+o[e[n+1]]+o[e[n+2]]+o[e[n+3]]+"-"+o[e[n+4]]+o[e[n+5]]+"-"+o[e[n+6]]+o[e[n+7]]+"-"+o[e[n+8]]+o[e[n+9]]+"-"+o[e[n+10]]+o[e[n+11]]+o[e[n+12]]+o[e[n+13]]+o[e[n+14]]+o[e[n+15]]}const W=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),v={randomUUID:W};function F(e,n,c){if(v.randomUUID&&!n&&!e)return v.randomUUID();e=e||{};const a=e.random||(e.rng||D)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,n){c=c||0;for(let l=0;l<16;++l)n[c+l]=a[l];return n}return L(a)}const N=({items:e,selectedItem:n,onSelect:c,width:a=100,label:l})=>{var m;x.useState(F());const[i,p]=x.useState(!1),s=x.useRef(null),j=()=>p(!i);return x.useEffect(()=>{const d=r=>{s.current&&!s.current.contains(r.target)&&p(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]),t.jsxs("div",{ref:s,className:`${l?"flex items-center justify-between bg-base-300 rounded-lg cursor-pointer group":""}`,onClick:j,style:{width:a},children:[l&&t.jsx("div",{className:"px-3 py-2",children:l}),t.jsxs("div",{className:"relative inline-block text-left",children:[t.jsxs("button",{className:"btn text-xs flex items-center justify-center px-3 whitespace-nowrap group-hover:bg-base-100 hover:bg-base-100",children:[t.jsx("p",{className:"pr-1 whitespace-nowrap",children:n}),t.jsx(g,{icon:C,className:"w-3 h-3"})]}),i&&t.jsx("div",{className:"z-10 absolute right-0 shadow-lg shadow-neutral-900 bg-base-200 rounded-md mt-1",style:{width:(m=s.current)==null?void 0:m.offsetWidth},children:t.jsx("ul",{className:"py-2 text-sm",children:e.map((d,r)=>t.jsx("li",{onClick:()=>{c(d),p(!1)},className:"block p-2 hover:bg-base-100",children:d},`tailwindcss-dropdown-item-${r}`))})})]})]})},_=({defaultChecked:e,onChange:n,labelText:c,width:a})=>t.jsx("div",{className:"form-control bg-base-300 rounded-lg px-2 items-center justify-center py-1",style:{width:a},children:c?t.jsxs("label",{className:"label cursor-pointer flex items-center justify-between w-full",children:[t.jsx("div",{className:"label-text text-sm pr-2",children:c}),t.jsx("input",{type:"checkbox",defaultChecked:e,onChange:n,className:"checkbox bg-base-200"})]}):t.jsx("input",{type:"checkbox",defaultChecked:e,onChange:n,className:"checkbox bg-base-200"})}),S=({settings:e,setSettings:n,handleCopy:c,handleDownload:a})=>{const l=()=>n(s=>({...e,textWrap:!s.textWrap})),i=s=>n({...e,lineSpacing:s}),p=s=>n({...e,textEncoding:s});return t.jsxs("div",{className:"flex flex-col justify-between gap-2 text-sm pr-3 max-w-[240px] w-full col-span-2 border-r-2 border-r-base-200",children:[t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx(_,{defaultChecked:e.textWrap,onChange:l,labelText:"Wrap text",width:"100%"}),t.jsx(N,{label:"Line spacing",items:w.lineSpacing,selectedItem:e.lineSpacing,onSelect:s=>i(s),width:"100%"}),t.jsx(N,{label:"Text encoding",items:w.textEncoding,selectedItem:e.textEncoding,onSelect:s=>p(s),width:"100%"})]}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsxs("button",{className:"btn btn-md",tabIndex:5,onClick:c,children:[t.jsx("p",{className:"pr-2",children:"Copy to clipboard"}),t.jsx(g,{icon:T,className:"h-5 w-5 text-gray-400"})]}),t.jsxs("button",{className:"btn btn-md",tabIndex:6,onClick:a,children:[t.jsx("div",{className:"pr-2",children:"Download .txt file"}),t.jsx(g,{icon:E,className:"h-5 w-5 text-gray-400"})]})]})]})},A=Object.freeze(Object.defineProperty({__proto__:null,default:S},Symbol.toStringTag,{value:"Module"})),$={textWrap:!1,lineSpacing:"none",textEncoding:"UTF-8"},w={textWrap:!1,lineSpacing:["none","single"],textEncoding:["UTF-8"]},M=()=>{const e=localStorage.getItem("excel-to-text-settings");return e?JSON.parse(e):$},P=({modalRef:e,text:n,setText:c})=>{const[a,l]=x.useState(""),[i,p]=x.useState(M()),s=x.useRef(null);x.useEffect(()=>{n&&s.current&&(s.current.focus(),l(()=>{const r=i.lineSpacing==="none"?1:2;return i.textWrap?n.map(b=>b.replace(/[\r\n]+/g," ")).join(`
`.repeat(r)):n.join(`
`.repeat(r))}))},[n,i]);const j=()=>{navigator.clipboard.writeText(a).then(()=>f.success("Text copied to clipboard!")).catch(r=>f.error(`Failed to copy text: 
${r}`,y))},m=()=>{const r=new Blob([a],{type:"text/plain"}),b=URL.createObjectURL(r),u=document.createElement("a");u.href=b,u.download="exported-text.txt",document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(b),f.success("File downloaded successfully!",y)},d=()=>{c(()=>(e.current.close(),null))};return t.jsx(t.Fragment,{children:t.jsxs("dialog",{ref:e,className:"modal",children:[t.jsxs("div",{className:"modal-box text-left max-w-4xl overflow-hidden",children:[t.jsx("form",{method:"dialog",children:t.jsx("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-4 mt-4 top-1",tabIndex:7,onClick:()=>d(),children:t.jsx(g,{icon:O,className:"w-8 h-8"})})}),t.jsxs("div",{className:"h-full grid grid-cols-7",children:[t.jsx("div",{className:"col-span-2 text-center flex items-center justify-center font-bold pb-4",children:"Text options"}),t.jsx("div",{className:"col-span-5 text-center flex items-center justify-center font-bold pb-4",children:"Text preview"}),t.jsx(S,{settings:i,setSettings:p,handleCopy:j,handleDownload:m}),t.jsx("div",{className:"flex flex-col grow pl-4 col-span-5 h-hull",children:t.jsx("textarea",{tabIndex:1,ref:s,className:"textarea h-full w-full border-transparent focus:border-transparent focus:ring-0 leading-5 bg-base-200 py-4",value:a,rows:24,onChange:r=>l(r.target.value)})})]})]}),t.jsx("form",{method:"dialog",className:"modal-backdrop bg-black bg-opacity-80 min-h-screen",onClick:()=>d(),children:t.jsx("button",{tabIndex:-1,children:"close"})}),t.jsx(U,{})]})})},J=Object.freeze(Object.defineProperty({__proto__:null,default:P,textEditorInitialOptions:w},Symbol.toStringTag,{value:"Module"}));export{U as C,P as T,A as a,J as b,y as c};
