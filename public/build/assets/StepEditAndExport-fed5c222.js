import{r as l,j as e}from"./app-e05131b1.js";import m from"./TextEditorOptions-aa068a3c.js";import p from"./MonacoEditor-44e1bac4.js";import{l as f}from"./LineSpacingHandler-c2184f67.js";import{a as h,e as d}from"./ExcelContentParser-78f58c95.js";import{Q as x}from"./ReactToastify-5b1e8a10.js";import{a as u}from"./ExcelToTextContext-3746a05a.js";import w from"./ForgeignCharTerminal-5a18ca2a.js";import"./index.es-3dcf387f.js";import"./index-afbedc42.js";const E=async(n,t)=>{try{const r=await fetch("/api/download-encoded-text-file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:n,encoding:t})});if(!r.ok)throw new Error("Network response was not ok");const i=await r.blob(),s=window.URL.createObjectURL(i),o=document.createElement("a");o.href=s,o.download="download.txt",document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(s),document.body.removeChild(o)}catch(r){console.error("Error during file download:",r)}},j=n=>{navigator.clipboard.writeText(n).then(()=>x.success("Text copied to clipboard!")).catch(t=>x.error(`Failed to copy text: 
${t}`,h))},S=({handlePreviousStep:n})=>{const{cells:t,primaryEditorCells:r,setPrimaryEditorCells:i,primaryEditorTextValue:s,setPrimaryEditorTextValue:o,settings:a,selectedColumnIndexes:y}=l.useContext(u),c=l.useRef(null);return l.useEffect(()=>{i(d(t,0))},[]),l.useEffect(()=>{o(()=>f(a,r??d(t,0)))},[a.textWrap,a.lineSpacing,a.textEncoding]),e.jsxs("div",{ref:c,className:"h-full flex flex-col",children:[e.jsxs("div",{className:"flex flex-grow",children:[" ",e.jsx("div",{className:"w-64",children:e.jsx(m,{handleCopy:()=>j(s),handleDownload:()=>E(s,a.textEncoding)})}),e.jsxs("div",{ref:c,className:"flex-grow flex flex-col",children:[e.jsx("div",{className:"flex-grow",children:e.jsx(p,{})}),e.jsx(w,{})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{className:"btn btn-primary",onClick:n,children:"Back"})})]})};export{S as default};
