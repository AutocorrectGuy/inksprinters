import{j as t,r as p}from"./app-afed1038.js";import{k as S,Q as j}from"./ReactToastify-15b362d7.js";import{f as k,a as T,b as C,c as E}from"./index-14966fff.js";import{F as b}from"./index.es-44f5bde0.js";import O from"./MonacoEditor-f4d6543a.js";const w={position:"top-right",autoClose:3e3,hideProgressBar:!0,closeOnClick:!0,pauseOnHover:!0,draggable:!1,progress:void 0,theme:"dark"},I=()=>t.jsx(S,{position:"top-right",autoClose:5e3,hideProgressBar:!0,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!1,draggable:!1,pauseOnHover:!0,theme:"dark",style:{zIndex:9999}}),U=I;let h;const D=new Uint8Array(16);function R(){if(!h&&(h=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!h))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return h(D)}const s=[];for(let e=0;e<256;++e)s.push((e+256).toString(16).slice(1));function L(e,n=0){return s[e[n+0]]+s[e[n+1]]+s[e[n+2]]+s[e[n+3]]+"-"+s[e[n+4]]+s[e[n+5]]+"-"+s[e[n+6]]+s[e[n+7]]+"-"+s[e[n+8]]+s[e[n+9]]+"-"+s[e[n+10]]+s[e[n+11]]+s[e[n+12]]+s[e[n+13]]+s[e[n+14]]+s[e[n+15]]}const W=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),y={randomUUID:W};function F(e,n,a){if(y.randomUUID&&!n&&!e)return y.randomUUID();e=e||{};const o=e.random||(e.rng||R)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,n){a=a||0;for(let l=0;l<16;++l)n[a+l]=o[l];return n}return L(o)}const v=({items:e,selectedItem:n,onSelect:a,width:o=100,label:l})=>{var u;p.useState(F());const[i,x]=p.useState(!1),c=p.useRef(null),g=()=>x(!i);return p.useEffect(()=>{const r=d=>{c.current&&!c.current.contains(d.target)&&x(!1)};return document.addEventListener("mousedown",r),()=>document.removeEventListener("mousedown",r)},[]),t.jsxs("div",{ref:c,className:`${l?"flex items-center justify-between bg-base-300 rounded-lg cursor-pointer group":""}`,onClick:g,style:{width:o},children:[l&&t.jsx("div",{className:"px-3 py-2",children:l}),t.jsxs("div",{className:"relative inline-block text-left",children:[t.jsxs("button",{className:"btn text-xs flex items-center justify-center px-3 whitespace-nowrap group-hover:bg-base-100 hover:bg-base-100",children:[t.jsx("p",{className:"pr-1 whitespace-nowrap",children:n}),t.jsx(b,{icon:k,className:"w-3 h-3"})]}),i&&t.jsx("div",{className:"z-10 absolute right-0 shadow-lg shadow-neutral-900 bg-base-200 rounded-md mt-1",style:{width:(u=c.current)==null?void 0:u.offsetWidth},children:t.jsx("ul",{className:"py-2 text-sm",children:e.map((r,d)=>t.jsx("li",{onClick:()=>{a(r),x(!1)},className:"block p-2 hover:bg-base-100",children:r},`tailwindcss-dropdown-item-${d}`))})})]})]})},_=({defaultChecked:e,onChange:n,labelText:a,width:o})=>t.jsx("div",{className:"form-control bg-base-300 rounded-lg px-2 items-center justify-center py-1",style:{width:o},children:a?t.jsxs("label",{className:"label cursor-pointer flex items-center justify-between w-full",children:[t.jsx("div",{className:"label-text text-sm pr-2",children:a}),t.jsx("input",{type:"checkbox",defaultChecked:e,onChange:n,className:"checkbox bg-base-200"})]}):t.jsx("input",{type:"checkbox",defaultChecked:e,onChange:n,className:"checkbox bg-base-200"})}),N=({settings:e,setSettings:n,handleCopy:a,handleDownload:o})=>{const l=()=>n(c=>({...e,textWrap:!c.textWrap})),i=c=>n({...e,lineSpacing:c}),x=c=>n({...e,textEncoding:c});return t.jsxs("div",{className:"flex flex-col justify-between gap-2 text-sm pr-3 max-w-[240px] w-full col-span-2 border-r-2 border-r-base-200",children:[t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx(_,{defaultChecked:e.textWrap,onChange:l,labelText:"Wrap text",width:"100%"}),t.jsx(v,{label:"Line spacing",items:f.lineSpacing,selectedItem:e.lineSpacing,onSelect:c=>i(c),width:"100%"}),t.jsx(v,{label:"Text encoding",items:f.textEncoding,selectedItem:e.textEncoding,onSelect:c=>x(c),width:"100%"})]}),t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsxs("button",{className:"btn btn-md",tabIndex:5,onClick:a,children:[t.jsx("p",{className:"pr-2",children:"Copy to clipboard"}),t.jsx(b,{icon:T,className:"h-5 w-5 text-gray-400"})]}),t.jsxs("button",{className:"btn btn-md",tabIndex:6,onClick:o,children:[t.jsx("div",{className:"pr-2",children:"Download .txt file"}),t.jsx(b,{icon:C,className:"h-5 w-5 text-gray-400"})]})]})]})},J=Object.freeze(Object.defineProperty({__proto__:null,default:N},Symbol.toStringTag,{value:"Module"})),M={textWrap:!1,lineSpacing:"none",textEncoding:"UTF-8"},f={textWrap:!1,lineSpacing:["none","single"],textEncoding:["UTF-8"]},$=()=>{const e=localStorage.getItem("excel-to-text-settings");return e?JSON.parse(e):M},P=({modalRef:e,text:n,setText:a})=>{const[o,l]=p.useState(""),[i,x]=p.useState($());p.useEffect(()=>{n&&l(()=>{const r=i.lineSpacing==="none"?1:2;return i.textWrap?n.map(d=>d.replace(/[\r\n]+/g," ")).join(`
`.repeat(r)):n.join(`
`.repeat(r))})},[n,i]);const c=()=>{navigator.clipboard.writeText(o).then(()=>j.success("Text copied to clipboard!")).catch(r=>j.error(`Failed to copy text: 
${r}`,w))},g=()=>{const r=new Blob([o],{type:"text/plain"}),d=URL.createObjectURL(r),m=document.createElement("a");m.href=d,m.download="exported-text.txt",document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(d),j.success("File downloaded successfully!",w)},u=()=>{a(()=>(e.current.close(),null))};return t.jsx(t.Fragment,{children:t.jsxs("dialog",{ref:e,className:"modal",children:[t.jsxs("div",{className:"modal-box text-left max-w-4xl overflow-hidden",children:[t.jsx("form",{method:"dialog",children:t.jsx("button",{className:"btn btn-sm btn-circle btn-ghost absolute right-4 mt-4 top-1",tabIndex:7,onClick:()=>u(),children:t.jsx(b,{icon:E,className:"w-8 h-8"})})}),t.jsxs("div",{className:"h-full grid grid-cols-7",children:[t.jsx("div",{className:"col-span-2 text-center flex items-center justify-center font-bold pb-4",children:"Text options"}),t.jsx("div",{className:"col-span-5 text-center flex items-center justify-center font-bold pb-4",children:"Text preview"}),t.jsx(N,{settings:i,setSettings:x,handleCopy:c,handleDownload:g}),t.jsx("div",{className:"flex flex-col grow pl-4 col-span-5 h-hull",children:t.jsx(O,{inputText:o,setInputText:l})})]})]}),t.jsx("form",{method:"dialog",className:"modal-backdrop bg-black bg-opacity-80 min-h-screen",onClick:()=>u(),children:t.jsx("button",{tabIndex:-1,children:"close"})}),t.jsx(U,{})]})})},Q=Object.freeze(Object.defineProperty({__proto__:null,default:P,textEditorInitialOptions:f},Symbol.toStringTag,{value:"Module"}));export{U as C,P as T,J as a,Q as b,w as c};
